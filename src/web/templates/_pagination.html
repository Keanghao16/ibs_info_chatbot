{% if total_pages > 1 %}
<div class="flex flex-wrap justify-center items-center gap-2 p-5">
    <!-- Previous Button -->
    <a href="?page={{ page - 1 }}&per_page={{ per_page }}" 
       class="px-3 py-2 rounded-lg border-2 font-semibold transition min-w-[40px] text-center
              {{ 'border-gray-200 bg-white text-gray-400 cursor-not-allowed' if page <= 1 else 'border-gray-200 bg-white text-gray-700 hover:border-primary-500 hover:text-primary-500 hover:bg-gray-50' }}"
       {{ 'onclick="return false;"' if page <= 1 else '' }}>
        <i class="fas fa-chevron-left"></i>
    </a>
    
    <!-- Page Numbers -->
    {% set start_page = [1, page - 2]|max %}
    {% set end_page = [total_pages, page + 2]|min %}
    
    {% if start_page > 1 %}
        <a href="?page=1&per_page={{ per_page }}" 
           class="px-3 py-2 rounded-lg border-2 border-gray-200 bg-white text-gray-700 font-semibold transition min-w-[40px] text-center hover:border-primary-500 hover:text-primary-500 hover:bg-gray-50">
            1
        </a>
        {% if start_page > 2 %}
            <span class="px-2 text-gray-500">...</span>
        {% endif %}
    {% endif %}
    
    {% for p in range(start_page, end_page + 1) %}
        <a href="?page={{ p }}&per_page={{ per_page }}" 
           class="px-3 py-2 rounded-lg border-2 font-semibold transition min-w-[40px] text-center
                  {{ 'gradient-primary text-white border-transparent' if p == page else 'border-gray-200 bg-white text-gray-700 hover:border-primary-500 hover:text-primary-500 hover:bg-gray-50' }}">
            {{ p }}
        </a>
    {% endfor %}
    
    {% if end_page < total_pages %}
        {% if end_page < total_pages - 1 %}
            <span class="px-2 text-gray-500">...</span>
        {% endif %}
        <a href="?page={{ total_pages }}&per_page={{ per_page }}" 
           class="px-3 py-2 rounded-lg border-2 border-gray-200 bg-white text-gray-700 font-semibold transition min-w-[40px] text-center hover:border-primary-500 hover:text-primary-500 hover:bg-gray-50">
            {{ total_pages }}
        </a>
    {% endif %}
    
    <!-- Next Button -->
    <a href="?page={{ page + 1 }}&per_page={{ per_page }}" 
       class="px-3 py-2 rounded-lg border-2 font-semibold transition min-w-[40px] text-center
              {{ 'border-gray-200 bg-white text-gray-400 cursor-not-allowed' if page >= total_pages else 'border-gray-200 bg-white text-gray-700 hover:border-primary-500 hover:text-primary-500 hover:bg-gray-50' }}"
       {{ 'onclick="return false;"' if page >= total_pages else '' }}>
        <i class="fas fa-chevron-right"></i>
    </a>
    
    <!-- Per Page Selector -->
    <select class="ml-2 px-3 py-2 rounded-lg border-2 border-gray-200 bg-white font-semibold cursor-pointer hover:border-primary-500 focus:outline-none focus:border-primary-500" 
            onchange="window.location.href='?page=1&per_page=' + this.value">
        <option value="10" {{ 'selected' if per_page == 10 else '' }}>10 per page</option>
        <option value="20" {{ 'selected' if per_page == 20 else '' }}>20 per page</option>
        <option value="50" {{ 'selected' if per_page == 50 else '' }}>50 per page</option>
        <option value="100" {{ 'selected' if per_page == 100 else '' }}>100 per page</option>
    </select>
</div>
{% endif %}